<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<!--
	CREATED BY : PRAVEEN
	DATE : 17-09-24
-->

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="/ASPIRA/js/jquery.min.js"></script>
<script src="/ASPIRA/js/jquery-ui.min.js"></script>
<style>
body {
	font-size: 0.8rem;
}

.btn {
	line-height: 0.5rem;
}

.table-bordered td, .table-bordered th {
	font-size: smaller;
}

.container-manager {
	width: 83.5%;
	padding-right: 15px;
	padding-left: 15px;
	margin-right: auto;
	margin-left: 17.3%;
	margin-top: 80px;
	margin-top: 80px;
}

.table .thead-light th {
	color: #495057;
	background-color: #e9ecef;
	border-color: #dee2e6;
	width: 23px;
}

.tablinks {
	background-color: #f2f2f2;
	color: #000;
}

.tablinks.active {
	background-color: #007bff;
	color: #fff;
}

.tab {
	overflow: hidden;
	border: 1px solid #ccc;
	background-color: #f1f1f1;
}

.scroll {
	max-height: 60vh;
	overflow-y: scroll;
	overflow-x: hidden;
}

.tab button {
	background-color: inherit;
	float: left;
	border: none;
	outline: none;
	cursor: pointer;
	padding: 14px 16px;
	transition: 0.3s;
	font-size: 17px;
}

.tab button:hover {
	background-color: #ddd;
}

.tabcontent {
	display: none;
	padding: 6px 12px;
	border: 0px solid #ccc;
	border-top: none;
}

#myPieChart {
	width: 100px;
	height: 100px;
}
</style>
<style>
.modal {
	display: none;
	position: fixed;
	z-index: 1;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.4);
	margin-left: 350px;
}

.modal-content {
	background-color: #fefefe;
	margin: 15% auto;
	padding: 20px;
	border: 1px solid #888;
	width: 70%;
	height: 50%;
	margin-left: 200px;
}

.modal-pass {
	background-color: #fefefe;
	margin: 15% auto;
	padding: 20px;
	border: 1px solid #888;
	width: 40%;
	height: 25%;
	margin-left: 400PX;
	margin-right: auto;
	border-radius: 10px;
	box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.2);
	font-family: Arial, sans-serif;
}

.close {
	color: red;
	font-size: 28px;
	font-weight: bold;
}

.close:hover, .close:focus {
	color: black;
	text-decoration: none;
	cursor: pointer;
}

.table-responsive {
	max-height: 600px;
	overflow-y: auto;
}

.table-responsive1 {
	max-height: 400px;
	overflow-y: auto;
}

table {
	width: 100%;
	border-collapse: collapse;
}

thead {
	position: sticky;
	top: 0;
	background-color: #f9f9f9;
	z-index: 10;
}

th, td {
	padding: 12px;
	text-align: left;
	border-bottom: 1px solid #ddd;
}

.filterable .filters input[disabled] {
	background-color: transparent;
	border: none;
	cursor: auto;
	box-shadow: none;
	padding: 0;
	height: auto;
}

.filterable .filters input[disabled]::-webkit-input-placeholder {
	color: #333;
}

.filterable .filters input[disabled]::-moz-placeholder {
	color: #333;
}

.filterable .filters input[disabled]:-ms-input-placeholder {
	color: #333;
}

.filterable .filters input[disabled]::-webkit-input-placeholder {
	color: #333;
}
.big-btn {
  font-size: 16px;
}
</style>
<style>
.password-info {
	visibility: hidden;
	width: 320px;
	background-color: #333;
	color: #fff;
	text-align: left;
	border-radius: 10px;
	padding: 10px;
	position: absolute;
	z-index: 1;
	top: calc(100% + 10px);
	left: 50%;
	transform: translateX(-50%);
	opacity: 0;
	transition: opacity 0.3s;
}

input:hover+.password-info {
	visibility: visible;
	opacity: 0.8;
}
</style>


<script>
	function Home() {

		location.href = 'Dashboard';
	}

	function Back() {
		window.history.back();
	}

	$(function() {
		$(
				"#doj,#dob,#date_of_offer,#date_of_appointment_letter,#aed,#ped,#dsd,#ded")
				.datepicker({
					dateFormat : "dd-mm-yy",
					changeMonth : true,
					changeYear : true

				});
	});
</script>
<script>
	function voucherGenerator() {

		location.href = './voucherMaintanace?formmode=generator';
	}

	function voucherUpload() {

		location.href = './voucherMaintanace?formmode=list';
	}

	function list() {

		location.href = './assosiateProfile?formmode=list';
	}
</script>

<script>

		
	function enquiryuser(a) {
		var acctno = a.getAttribute("data-attr");
		location.href = 'accountLedger?formmode=view&acct_num=' + acctno;
	}
	
	document.addEventListener("DOMContentLoaded", function() {
        const dateInput = document.getElementById("reportDate");
        const trandateGet = document.getElementById("trandateget").value;
        
        // Convert 'dd-MM-yyyy' to 'yyyy-MM-dd' format
        const parts = trandateGet.split("-");
        const formattedDate = `${parts[2]}-${parts[1]}-${parts[0]}`;

        // Set the formatted date to the date input
        dateInput.value = formattedDate;
    });
	//Filter Table
		
		$(document)
			.ready(
					function() {
						$('.filterable .btn-filter')
								.click(
										function() {
											var $panel = $(this).parents(
													'.filterable'), $filters = $panel
													.find('.filters input'), $tbody = $panel
													.find('.table tbody');
											if ($filters.prop('disabled') == true) {
												$filters
														.prop('disabled', false);
												$filters.first().focus();
											} else {
												$filters.val('').prop(
														'disabled', true);
												$tbody.find('.no-result')
														.remove();
												$tbody.find('tr').show();
											}
										});

						$('.filterable .filters input')
								.keyup(
										function(e) {
											/* Ignore tab key */
											var code = e.keyCode || e.which;
											if (code == '9')
												return;
											/* Useful DOM data and selectors */
											var $input = $(this), inputContent = $input
													.val().toLowerCase(), $panel = $input
													.parents('.filterable'), column = $panel
													.find('.filters th')
													.index($input.parents('th')), $table = $panel
													.find('.table'), $rows = $table
													.find('tbody tr');
											/* Dirtiest filter function ever ;) */
											var $filteredRows = $rows
													.filter(function() {
														var value = $(this)
																.find('td').eq(
																		column)
																.text()
																.toLowerCase();
														return value
																.indexOf(inputContent) === -1;
													});
											/* Clean previous no-result if exist */
											$table.find('tbody .no-result')
													.remove();
											/* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
											$rows.show();
											$filteredRows.hide();
											/* Prepend no-result row if all rows are filtered */
											if ($filteredRows.length === $rows.length) {
												$table
														.find('tbody')
														.prepend(
																$('<tr class="no-result text-center"><td colspan="'
																		+ $table
																				.find('.filters th').length
																		+ '">No result found</td></tr>'));
											}
										});
					});
	
</script>
<script>
	function adjustHeight() {
		const cardBody = document.getElementById("cardBody");
		const viewportHeight = window.innerHeight;
		cardBody.style.maxHeight = `${viewportHeight * 0.90}px`; // Adjust 80% of the viewport height
	}

	window.addEventListener("resize", adjustHeight);
	document.addEventListener("DOMContentLoaded", adjustHeight);
</script>

</head>


<body>

	<div class="col-sm-2">
		<div th:insert="BGLSHeaderMenu :: header"></div>
	</div>
	<!---------------------User List Starts------------------------------------------------------->
	<!-- Start Content-->
	<div class="container-manager">



		<div class="row">


			<div class="col-sm-11 ml-5 mt-2" style="font-size: 0.8rem;">


				<!-- ------------------------------------Trail Balance Reports List---------------------------------- -->
				<div th:if="${formmode}=='list'">

					<div class="panel panel-primary filterable">
						<div class="card w-100 border panel panel-primary filterable">

							<div class="card-header"
								style="background-color: #e9ecef; height: 50px">
								<div class="float-left">
									<h6 class="ml-2"
										style=" font-size: 1.2rem; color: black;">TRAIL
										BALANCE- REPORTS</h6>
								</div>

								<div
									class="float-right d-flex justify-content-end align-items-center"
									style="flex-wrap: nowrap;">
									<button type="button"
										class="btn-primary big-btn btn-filter">Filter</button>
									<input type="date" name="reportDate" id="reportDate"
										th:value="${TRANDATE}"
										class="form-control form-control-sm bg-white border border-dark ml-1" />
								</div>


								<input type="text" id="trandateget"
									th:value="${#dates.format(TRANDATE, 'dd-MM-yyyy')}"
									class="form-control font-weight-bold" placeholder="HEAD" hidden>

							</div>
							<div class="card-body">

								<div class="table-responsive mt-2" id="cardBody">
									<table class="table  table-bordered  table-hover table-sm"
										style="margin-bottom: 0px; font-size: initial;" id="usertable">

										<thead class="thead-light">
											<tr class="filters">
											<th><input type="text"
													class="form-control font-weight-bold" placeholder="GL CODE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="ACCOUNT NAME"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="OPENING BALANCE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="CREDIT"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="DEBIT"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="NET CHANGE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="CLOSING BALANCE"
													disabled></th>
											</tr>
										</thead>

										<tbody id="placelist">
											<tr th:each="Trial: ${trialbal}" th:if="${trialbal != null}">

												<td th:text="${Trial[0]}"
													th:attr="data-glshcode=${Trial[0]}"
													onclick="viewglsh(this);" style="color: blue;"></td>
												<!-- gl_code -->
												<td th:text="${Trial[1]}"></td>
												<td
													th:text="${(Trial[2] != null and Trial[2] != 0) ? #numbers.formatDecimal(Trial[2] / 1000000, 0, 'COMMA', 2, 'POINT') : '0.00'}"
													style="text-align: right"></td>
												<!-- opening_bal in millions -->
												<td
													th:text="${(Trial[3] != null and Trial[3] != 0) ? #numbers.formatDecimal(Trial[3] / 1000000, 0, 'COMMA', 2, 'POINT') : '0.00'}"
													style="text-align: right"></td>
												<!-- credit in millions -->

												<td
													th:text="${(Trial[4] != null and Trial[4] != 0) ? #numbers.formatDecimal(Trial[4] / 1000000, 0, 'COMMA', 2, 'POINT') : '0.00'}"
													style="text-align: right"></td>
												<!-- debit in millions -->

												<td
													th:text="${(Trial[5] != null and Trial[5] != 0) ? #numbers.formatDecimal(Trial[5] / 1000000, 0, 'COMMA', 2, 'POINT') : '0.00'}"
													style="text-align: right"></td>
												<!-- net_change in millions -->

												<td
													th:text="${(Trial[6] != null and Trial[6] != 0) ? #numbers.formatDecimal(Trial[6] / 1000000, 0, 'COMMA', 2, 'POINT') : '0.00'}"
													style="text-align: right"></td>
												<!-- closing_bal in millions -->

											</tr>
										</tbody>
									</table>
								</div>
								<div class="table-responsive mt-2">
									<table class="table  table-bordered  table-hover table-sm"
										style="margin-bottom: 0px; font-size: initial; display: none;"
										id="GLSHlist">

										<thead class="thead-light">
											<tr class="filters">
												<th><input type="text"
													class="form-control font-weight-bold" placeholder="GL CODE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="ACCOUNT NAME"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="OPENING BALANCE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="CREDIT"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="DEBIT"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="NET CHANGE"
													disabled></th>
													<th><input type="text"
													class="form-control font-weight-bold" placeholder="CLOSING BALANCE"
													disabled></th>
											</tr>
										</thead>

										<tbody id="glshbody">
											<!-- <tr th:each="Trial: ${trialbalance}" th:if="${trialbalance != null}"> 
												<td th:text="${Trial.classification}"></td>
												<td th:text="${Trial.gl_code}"></td>
												<td th:text="${Trial.gl_desc}"></td>
												<td th:text="${Trial.glsh_code}"></td>
												<td th:text="${Trial.glsh_desc}"></td>
												<td th:text="${Trial.acct_num}"></td>
												<td th:text="${Trial.acct_name}"></td>
												<td th:text="${Trial.acct_crncy}"></td> 
												<td style="text-align: right"
													th:text="${Trial.acct_bal > 0 ? #numbers.formatDecimal(Trial.acct_bal, 0, 'COMMA', 2, 'POINT') : '0.00'}">
												</td> 
												<td style="text-align: right"
													th:text="${Trial.acct_bal <= 0 ? #numbers.formatDecimal(Trial.acct_bal, 0, 'COMMA', 2, 'POINT') : '0.00'}">
												</td>
											</tr>  -->
										</tbody>
									</table>
								</div>
								<br>
								<div class="row-formline"
									style="display: flex; align-items: right; justify-content: right; margin-right: 30px; margin-top: 10px; margin-bottom: 10px; font-size: 16px">
									<div
										style="text-align: center; font-weight: bold; margin-right: 470px">Total</div>
									<div id="totalCredits"
										style="text-align: right; font-weight: bold; margin-right: 45px"></div>

									<div id="totalDebits"
										style="text-align: right; font-weight: bold"></div>
								</div>
							</div>
							<div class="card-footer text-center mt-2"
								style="background-color: #e9ecef">
								<button class="btn-primary big-btn" onclick="Home();">Home</button>
								<button class="btn-primary big-btn" onclick="Back();">Back</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal fade" data-backdrop="false" data-keyboard="false" id="alert" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content" style="margin-left: -32%; width: 92%;height: 15%;">
				<div class="modal-body" style="text-align: center;">
					<h6 id="alertmsg"></h6>
					<!--<button type="button" class="btn-primary big-btn" onclick="tab2()">Close</button>-->
					<div>
					<button type="button" class="btn-primary big-btn" data-dismiss="modal">Close</button>
</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
let balancedate;

document.addEventListener('DOMContentLoaded', function () {
    const dateInput = document.getElementById('reportDate');
    const today = new Date();
    const todayStr = today.toISOString().split('T')[0]; // yyyy-MM-dd format

    // Always prevent selecting future dates
    dateInput.setAttribute('max', todayStr);

    // If no value or a future date is set, default to today
    if (!dateInput.value || dateInput.value > todayStr) {
        dateInput.value = todayStr;
    }

    // When user changes date
    dateInput.addEventListener('change', function () {
        balancedate = this.value;

        // Prevent selecting future date
        if (balancedate > todayStr) {
            alert('Future dates beyond ' + todayStr + ' are not allowed!');
            this.value = todayStr;
            balancedate = todayStr;
        }

        console.log('Selected Date:', balancedate);
        const glshTable = $('#GLSHlist');
        glshTable.css('display', 'none');

        $.ajax({
            url: './trialBalanceReports1',
            data: { balancedate: balancedate },
            type: 'GET',
            success: function (data) {
                console.log('Data received:', data);

                $('#placelist').empty();
                let totalCredits = 0;
                let totalDebits = 0;

                if (data.length === 0) {
                    $('#placelist').append(`
                        <tr>
                            <td colspan="9" class="text-center text-danger">No data available</td>
                        </tr>
                    `);
                    document.getElementById('totalCredits').textContent = '0.00';
                    document.getElementById('totalDebits').textContent = '0.00';
                    return;
                }

                data.forEach(trial => {
                    // Convert to millions and parse float
                    const value2 = trial[2] ? parseFloat(trial[2]) / 1000000 : 0.00; // trial[2]
                    const creditValue = trial[3] ? parseFloat(trial[3]) / 1000000 : 0.00; // credit
                    const debitValue = trial[4] ? parseFloat(trial[4]) / 1000000 : 0.00;  // debit
                    const netChange = trial[5] ? parseFloat(trial[5]) / 1000000 : 0.00;  // net_change
                    const closingBal = trial[6] ? parseFloat(trial[6]) / 1000000 : 0.00; // closing_bal

                    totalCredits += creditValue;
                    totalDebits += debitValue;

                    // Format numbers with 2 decimals
                    const formattedValue2 = value2.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedCredit = creditValue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedDebit = debitValue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedNetChange = netChange.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    const formattedClosingBal = closingBal.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });

                    $('#placelist').append(`
                        <tr>
                            <td class="text-primary" data-glshcode="${trial[0]}" data-date="${balancedate}" onclick="viewglshDAB(this);">${trial[0]}</td>
                            <td>${trial[1]}</td>
                            <td style="text-align: right">${formattedValue2}</td>
                            <td style="text-align: right">${formattedCredit}</td>
                            <td style="text-align: right">${formattedDebit}</td>
                            <td style="text-align: right">${formattedNetChange}</td>
                            <td style="text-align: right">${formattedClosingBal}</td>
                        </tr>
                    `);
                });

                document.getElementById('totalCredits').textContent = totalCredits.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                document.getElementById('totalDebits').textContent = totalDebits.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            },
            error: function (err) {
                console.error('Error fetching data:', err);
            }
        });
    });
});
</script>
<script>
// Function to calculate total credits and debits
function calculateTotals() {
    let totalCredits = 0;
    let totalDebits = 0;

    // Get all rows in the tbody
    const rows = document.querySelectorAll('#placelist tr');

    // Iterate through each row (except the last one which contains totals)
    for (let i = 0; i < rows.length - 1; i++) {
        const creditCell = rows[i].cells[7]; // Column index for credits
        const debitCell = rows[i].cells[8]; // Column index for debits

        const creditValue = parseFloat(creditCell.textContent.replace(/,/g, '')) || 0; // Parse credit value
        const debitValue = parseFloat(debitCell.textContent.replace(/,/g, '')) || 0; // Parse debit value

        totalCredits += creditValue; // Sum credits
        totalDebits += debitValue; // Sum debits
    }

    // Display totals in the last row
    document.getElementById('totalCredits').textContent = totalCredits.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    document.getElementById('totalDebits').textContent = Math.abs(totalDebits).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");


    const balance = totalCredits - Math.abs(totalDebits);

    document.getElementById('totalBalance').textContent = balance.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");

}

// Call the function to calculate totals after the DOM is loaded
document.addEventListener('DOMContentLoaded', calculateTotals);
</script>
<script type="text/javascript">
var currentGlshCode = null; // Variable to track the currently active GLSH Code

function formatDecimal(value) {
    value = value || 0;
    return value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function viewglsh(element) {
	document.getElementById('loadingModal').style.display = 'flex';
    var glshCode = element.getAttribute('data-glshcode'); 
   
    if (!glshCode) {
        // Set the message in the modal
        $('#alertmsg').text("GLSH Code not found.");
        // Show the modal
        $('#alert').modal('show');
        return;
    }


    var glshTable = $('#GLSHlist');

    // Check if the same glshCode is clicked again
    if (currentGlshCode === glshCode && glshTable.is(':visible')) {
        glshTable.hide(); // Hide the table
        currentGlshCode = null; // Reset the active GLSH Code
        return;
    }

    // Update the current GLSH Code
    currentGlshCode = glshCode;
    glshTable.show(); // Show the table

    // Make AJAX request to fetch data for the selected GLSH Code
    $.ajax({
        url: 'BGLS/ghlslistdata',
        type: 'GET',
        data: { glshCode: glshCode },
        success: function(response) {
        	document.getElementById('loadingModal').style.display = 'none';
            console.log(response);

            if (!response || response.length === 0) {
            	    // Set the message in the modal
            	    $('#alertmsg').text("No data found for the given GLSH Code.");
            	    // Show the modal
            	    $('#alert').modal('show');
                return;
            }

            var tbody = $('#glshbody');
            tbody.empty();

            $.each(response, function(index, trial) {
                var credit = trial.acct_bal > 0 ? formatDecimal(trial.acct_bal) : '0.00';
                var debit = trial.acct_bal <= 0 ? formatDecimal(Math.abs(trial.acct_bal)) : '0.00';

                var row = `
                    <tr> 
                      <td>${trial.glsh_code}</td>
                      <td>${trial.acct_num}</td>
                      <td>${trial.acct_name}</td> 
                      <td style="text-align: right">${credit}</td>
                      <td style="text-align: right">${debit}</td>
                    </tr>`;
                
                tbody.append(row);
            });
        },
        error: function(xhr, status, error) {
        	document.getElementById('loadingModal').style.display = 'none';
            console.error("Error fetching data: ", error);
            $('#alertmsg').text("Failed to fetch data. Please try again.");
    	    $('#alert').modal('show');
        }
    });
}

function viewglshDAB(element) {
	document.getElementById('loadingModal').style.display = 'flex';
    var glshCode = element.getAttribute('data-glshcode'); 
    var reportdate = element.getAttribute('data-date');
    if (!glshCode) {
    	$('#alertmsg').text("GLSH Code not found.");
	    $('#alert').modal('show');
        return;
    }

    var glshTable = $('#GLSHlist');

    // Check if the same glshCode is clicked again
    if (currentGlshCode === glshCode && glshTable.is(':visible')) {
        glshTable.hide(); // Hide the table
        currentGlshCode = null; // Reset the active GLSH Code
        return;
    }

    // Update the current GLSH Code
    currentGlshCode = glshCode;
    glshTable.show(); // Show the table

    // Make AJAX request to fetch data for the selected GLSH Code
    $.ajax({
        url: 'BGLS/ghlslistdataDAB',
        type: 'GET',
        data: { glshCode: glshCode,
        	reportdate: reportdate
        	},
        success: function(response) {
        	document.getElementById('loadingModal').style.display = 'none';
            console.log(response);

            if (!response || response.length === 0) {
            	$('#alertmsg').text("No data found for the given GLSH Code.");
        	    $('#alert').modal('show');
                return;
            }

            var tbody = $('#glshbody');
            tbody.empty();

            $.each(response, function(index, trial) {
                var credit = trial.total_credit > 0 ? formatDecimal(trial.total_credit) : '0.00';
                var debit = trial.total_debit > 0 ? formatDecimal(trial.total_debit) : '0.00';

                var row = `
                    <tr> 
                      <td>${trial.glsh_code}</td>
                      <td>${trial.acct_num}</td>
                      <td>${trial.acct_name}</td> 
                      <td style="text-align: right">${credit}</td>
                      <td style="text-align: right">${debit}</td>
                    </tr>`;
                
                tbody.append(row);
            });
        },
        error: function(xhr, status, error) {
        	document.getElementById('loadingModal').style.display = 'none';
            console.error("Error fetching data: ", error);
            $('#alertmsg').text("Failed to fetch data. Please try again.");
    	    $('#alert').modal('show');
        }
    });

}
</script>
</html>